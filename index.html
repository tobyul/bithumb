<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ë¹—ì¸ ì‹œì„¸ AG Grid</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-grid.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-theme-alpine.css" />
  <style>
    body { background: #f5f5f5; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 20px; }
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 { text-align: center; margin-bottom: 20px; color: #333; }
    .refresh-btn {
      display: block;
      margin: 0 auto 20px auto;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 8px 16px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .refresh-btn:hover { background: #0056b3; }
    #myGrid { height: 600px; width: 100%; }
    .loading { text-align: center; color: #666; margin: 20px 0; }
    .coin-name { font-size: 12px; color: #666; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸª™ ë¹—ì¸ ì•”í˜¸í™”í ì‹¤ì‹œê°„ ì‹œì„¸</h1>
    <button class="refresh-btn" onclick="loadCryptoData()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
    <div id="loading" class="loading" style="display: none;">ë°ì´í„° ë¡œë”© ì¤‘...</div>
    <div id="myGrid" class="ag-theme-alpine"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>
  <script>
    let gridApi;

    // ì•”í˜¸í™”í ì‹¬ë³¼ê³¼ í•œêµ­ì–´ ì´ë¦„ ë§¤í•‘
    const coinNames = {
      'BTC': 'ë¹„íŠ¸ì½”ì¸',
      'ETH': 'ì´ë”ë¦¬ì›€',
      'XRP': 'ë¦¬í”Œ',
      'BCH': 'ë¹„íŠ¸ì½”ì¸ìºì‹œ',
      'LTC': 'ë¼ì´íŠ¸ì½”ì¸',
      'EOS': 'ì´ì˜¤ìŠ¤',
      'ETC': 'ì´ë”ë¦¬ì›€í´ë˜ì‹',
      'XLM': 'ìŠ¤í…”ë¼ë£¨ë©˜',
      'ADA': 'ì—ì´ë‹¤',
      'DOT': 'í´ì¹´ë‹·',
      'LINK': 'ì²´ì¸ë§í¬',
      'TRX': 'íŠ¸ë¡ ',
      'VET': 'ë¹„ì²´ì¸',
      'THETA': 'ì‹œíƒ€',
      'BNB': 'ë°”ì´ë‚¸ìŠ¤ì½”ì¸',
      'MATIC': 'í´ë¦¬ê³¤',
      'SOL': 'ì†”ë¼ë‚˜',
      'AVAX': 'ì•„ë°œë€ì²´',
      'DOGE': 'ë„ì§€ì½”ì¸',
      'SHIB': 'ì‹œë°”ì´ëˆ„',
      'UNI': 'ìœ ë‹ˆìŠ¤ì™‘',
      'ATOM': 'ì½”ìŠ¤ëª¨ìŠ¤',
      'ALGO': 'ì•Œê³ ëœë“œ',
      'ICP': 'ì¸í„°ë„·ì»´í“¨í„°',
      'FIL': 'íŒŒì¼ì½”ì¸',
      'AAVE': 'ì—ì´ë¸Œ',
      'COMP': 'ì»´íŒŒìš´ë“œ',
      'MKR': 'ë©”ì´ì»¤',
      'SUSHI': 'ìŠ¤ì‹œìŠ¤ì™‘',
      'CRV': 'ì»¤ë¸Œ',
      'BAT': 'ë² ì´ì§ì–´í…ì…˜í† í°',
      'ZRX': 'ì œë¡œì—‘ìŠ¤',
      'MANA': 'ë””ì„¼íŠ¸ëŸ´ëœë“œ',
      'SAND': 'ìƒŒë“œë°•ìŠ¤',
      'ENJ': 'ì—”ì§„ì½”ì¸',
      'CHZ': 'ì¹ ë¦¬ì¦ˆ',
      'FLOW': 'í”Œë¡œìš°',
      'KLAY': 'í´ë ˆì´íŠ¼',
      'WEMIX': 'ìœ„ë¯¹ìŠ¤',
      'QTUM': 'í€€í…€',
      'LSK': 'ë¦¬ìŠ¤í¬',
      'STEEM': 'ìŠ¤íŒ€',
      'STRAX': 'ìŠ¤íŠ¸ë¼í‹°ìŠ¤',
      'ARDR': 'ì•„ë”',
      'STORJ': 'ìŠ¤í† ë¦¬ì§€',
      'GRT': 'ë”ê·¸ë˜í”„',
      'BAL': 'ë°¸ëŸ°ì„œ',
      'REN': 'ë Œ',
      'KNC': 'ì¹´ì´ë²„ë„¤íŠ¸ì›Œí¬',
      'ZIL': 'ì§ˆë¦¬ì¹´',
      'WAVES': 'ì›¨ì´ë¸Œ',
      'ICX': 'ì•„ì´ì½˜',
      'OMG': 'ì˜¤ë¯¸ì„¸ê³ ',
      'ANKR': 'ì•µì»¤',
      'CTC': 'í¬ë ˆë”§ì½”ì¸',
      'SBD': 'ìŠ¤íŒ€ë‹¬ëŸ¬',
      'POLA': 'í´ë¼ë¦¬ìŠ¤ì‰ì–´',
      'TEMCO': 'í…œì½”',
      'HIBS': 'í•˜ì´ë¸Œ',
      'SOLVE': 'ì†”ë¸Œì¼€ì–´',
      'HBAR': 'í—¤ë°ë¼í•´ì‹œê·¸ë˜í”„',
      'IOST': 'ì•„ì´ì˜¤ì—ìŠ¤í‹°',
      'AERGO': 'ì•„ë¥´ê³ ',
      'DAWN': 'ë˜í”„ë¡œí† ì½œ',
      'META': 'ë©”íƒ€ë””ì›€',
      'TFUEL': 'ì‹œíƒ€í“¨ì—˜',
      'ORBS': 'ì˜¤ë¸ŒìŠ¤',
      'VALOR': 'ë°¸ëŸ¬í† í°',
      'CON': 'ì½”ë„Œí† í°',
      'ANKR': 'ì•µì»¤',
      'BORA': 'ë³´ë¼',
      'JST': 'ì €ìŠ¤íŠ¸',
      'CRO': 'í¬ë¡œë…¸ìŠ¤',
      'TON': 'í†¤ì½”ì¸',
      'BLUR': 'ë¸”ëŸ¬',
      'PEPE': 'í˜í˜',
      'APT': 'ì•±í† ìŠ¤',
      'OP': 'ì˜µí‹°ë¯¸ì¦˜',
      'ARB': 'ì•„ë¹„íŠ¸ëŸ¼',
      'SUI': 'ìˆ˜ì´',
      'WLD': 'ì›”ë“œì½”ì¸',
      'TIA': 'ì…€ë ˆìŠ¤í‹°ì•„',
      'STRK': 'ìŠ¤íƒ€í¬ë„·',
      'PYTH': 'í”¼ìŠ¤ë„¤íŠ¸ì›Œí¬',
      'JUP': 'ì£¼í”¼í„°',
      'W': 'ì›œí™€',
      'ENA': 'ì—ë‚˜',
      'REZ': 'ë¦¬ì§ˆë¦¬ì–¸íŠ¸',
      'ETHFI': 'ì´ë”íŒŒì´',
      'PENDLE': 'íœë“¤',
      'RUNE': 'í† ë¥´ì²´ì¸',
      'NEAR': 'ë‹ˆì–´í”„ë¡œí† ì½œ',
      'FTM': 'íŒ¬í…€',
      'IMX': 'ì´ë®¤í„°ë¸”ì—‘ìŠ¤',
      'INJ': 'ì¸ì í‹°ë¸Œ',
      'LUNC': 'ë£¨ë‚˜í´ë˜ì‹',
      'USTC': 'í…Œë¼USDí´ë˜ì‹',
      'LUNA': 'ë£¨ë‚˜',
      'APE': 'ì—ì´í”„ì½”ì¸',
      'GALA': 'ê°ˆë¼',
      'AXS': 'ì•¡ì‹œì¸í”¼ë‹ˆí‹°',
      'GMT': 'ìŠ¤í…Œí”ˆ',
      'STEPN': 'ìŠ¤í…Œí”ˆ',
      'JASMY': 'ì¬ìŠ¤ë¯¸',
      'KAVA': 'ì¹´ë°”',
      'ROSE': 'ì˜¤ì•„ì‹œìŠ¤',
      'CELO': 'ì…€ë¡œ',
      'MINA': 'ë¯¸ë‚˜',
      '1INCH': 'ì›ì¸ì¹˜',
      'AUDIO': 'ì˜¤ë””ìš°ìŠ¤',
      'CTK': 'ì¨í‹±',
      'BAND': 'ë°´ë“œí”„ë¡œí† ì½œ',
      'ALPHA': 'ì•ŒíŒŒíŒŒì´ë‚¸ìŠ¤',
      'MDX': 'ë§¨ë±ìŠ¤',
      'WAXP': 'ì™ìŠ¤',
      'KARA': 'ì¹´ë¼ìŠ¤íƒ€',
      'SSX': 'ì¸ì”½',
      'HUNT': 'í—ŒíŠ¸',
      'PLA': 'í”Œë ˆì´ëŒ‘',
      'LOOM': 'ë£¸ë„¤íŠ¸ì›Œí¬',
      'BZRX': 'ë¹„ì§€ì—‘ìŠ¤',
      'WIKEN': 'ìœ„ì¼„',
      'OBSR': 'ì˜µì €ë²„',
      'MILK': 'ë°€í¬',
      'BIOT': 'ë°”ì´ì˜¤íŒ¨ìŠ¤í¬íŠ¸',
      'DUBBZ': 'ë”ë¸”ì¦ˆ',
      'FLOKI': 'í”Œë¡œí‚¤',
      'BONK': 'ë´‰í¬',
      'MEME': 'ë©”ë©”ì½”ì¸',
      'WIF': 'ë„ê·¸ìœ„ë“œí–‡',
      'POPCAT': 'íŒìº£',
      'BRETT': 'ë¸Œë ›',
      'NEIRO': 'ë„¤ì´ë¡œ',
      'GOAT': 'ê³ íŠ¸',
      'PNUT': 'í”¼ë„›',
      'ACT': 'ì•¡íŠ¸',
      'EIGEN': 'ì•„ì´ê²',
      'USUAL': 'ìœ ì£¼ì–¼',
      'MOVE': 'ë¬´ë¸Œ',
      'ME': 'ë§¤ì§ì—ë´',
      'VIRTUAL': 'ë²„ì¶”ì–¼',
      'AI16Z': 'AI16Z',
      'GRIFFAIN': 'ê·¸ë¦¬í˜ì¸',
      'VANA': 'ë°”ë‚˜',
      'VELODROME': 'ë²¨ë¡œë“œë¡¬',
      'HYPERLIQUID': 'í•˜ì´í¼ë¦¬í€´ë“œ',
      'FARTCOIN': 'íŒŒíŠ¸ì½”ì¸'
    };

    // ì½”ì¸ëª… ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
    const getCoinName = (symbol) => {
      return coinNames[symbol] || symbol;
    };

    // í¬ë§·íŒ… í•¨ìˆ˜ë“¤
    const formatPrice = (value) => {
      if (!value || value === '0') return '0';
      return parseFloat(value).toLocaleString('ko-KR') + ' ì›';
    };

    const formatVolume = (value) => {
      if (!value || value === '0') return '0';
      const num = parseFloat(value);
      if (num >= 1000000) return (num/1000000).toFixed(2) + 'M';
      if (num >= 1000) return (num/1000).toFixed(2) + 'K';
      return num.toFixed(4);
    };

    const formatRate = (value) => {
      if (!value || value === '0') return '0.00%';
      const rate = parseFloat(value);
      return (rate > 0 ? '+' : '') + rate.toFixed(2) + '%';
    };

    // ì‹¬ë³¼ê³¼ ì½”ì¸ëª…ì„ í•¨ê»˜ í‘œì‹œí•˜ëŠ” ë Œë”ëŸ¬
    const symbolCellRenderer = (params) => {
      const symbol = params.value;
      const coinName = getCoinName(symbol);
      return `<div style="font-weight: bold;">${symbol}</div><div class="coin-name">${coinName}</div>`;
    };

    // AG Grid ì˜µì…˜
    const gridOptions = {
      columnDefs: [
        { 
          field: 'symbol', 
          headerName: 'ì•”í˜¸í™”í', 
          width: 140, 
          pinned: 'left',
          cellRenderer: symbolCellRenderer,
          cellStyle: { padding: '8px' }
        },
        { 
          field: 'closing_price', 
          headerName: 'í˜„ì¬ê°€', 
          width: 120, 
          valueFormatter: params => formatPrice(params.value), 
          cellStyle: { fontWeight: 'bold', color: '#007bff' }
        },
        { 
          field: 'fluctate_rate_24H', 
          headerName: '24H ë³€ë™ë¥ ', 
          width: 120, 
          valueFormatter: params => formatRate(params.value),
          cellStyle: params => ({
            color: parseFloat(params.value) > 0 ? '#dc3545' : parseFloat(params.value) < 0 ? '#007bff' : '#333',
            fontWeight: 'bold'
          })
        },
        { 
          field: 'opening_price', 
          headerName: 'ì‹œê°€', 
          width: 120, 
          valueFormatter: params => formatPrice(params.value) 
        },
        { 
          field: 'min_price', 
          headerName: 'ìµœì €ê°€', 
          width: 120, 
          valueFormatter: params => formatPrice(params.value), 
          cellStyle: { color: '#dc3545' } 
        },
        { 
          field: 'max_price', 
          headerName: 'ìµœê³ ê°€', 
          width: 120, 
          valueFormatter: params => formatPrice(params.value), 
          cellStyle: { color: '#28a745' } 
        },
        { 
          field: 'units_traded', 
          headerName: 'ê±°ë˜ëŸ‰', 
          width: 120, 
          valueFormatter: params => formatVolume(params.value) 
        },
        { 
          field: 'acc_trade_value', 
          headerName: 'ê±°ë˜ëŒ€ê¸ˆ', 
          width: 140, 
          valueFormatter: params => formatPrice(params.value) 
        }
      ],
      defaultColDef: {
        sortable: true,
        filter: true,
        resizable: true,
        minWidth: 100
      },
      rowData: [],
      rowHeight: 60, // í–‰ ë†’ì´ ì¦ê°€ë¡œ ì‹¬ë³¼ê³¼ ì½”ì¸ëª… ëª¨ë‘ í‘œì‹œ
      onGridReady: function(params) {
        gridApi = params.api;
        loadCryptoData();
      }
    };

    // ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
    async function loadCryptoData() {
      const loadingDiv = document.getElementById('loading');
      loadingDiv.style.display = 'block';

      try {
        // ì‹¤ì œ ë¹—ì¸ API í˜¸ì¶œ
        const response = await fetch('https://api.bithumb.com/public/ticker/ALL_KRW');
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.status !== '0000') {
          throw new Error('API ì‘ë‹µ ì˜¤ë¥˜: ' + data.message);
        }

        // ë°ì´í„° ë³€í™˜
        const cryptoData = Object.keys(data.data)
          .filter(symbol => symbol !== 'date')
          .map(symbol => ({
            symbol,
            coinName: getCoinName(symbol),
            ...data.data[symbol]
          }))
          .sort((a, b) => parseFloat(b.closing_price) - parseFloat(a.closing_price));

        // AG Gridì— ë°ì´í„° ì„¤ì •
        gridApi.setGridOption('rowData', cryptoData);
        
        console.log(`${cryptoData.length}ê°œì˜ ì•”í˜¸í™”í ë°ì´í„°ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`);

      } catch (error) {
        console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
        
        // CORS ì˜¤ë¥˜ ì‹œ ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš©
        const sampleData = [
          {
            symbol: 'BTC',
            coinName: 'ë¹„íŠ¸ì½”ì¸',
            opening_price: '158770000',
            closing_price: '159708000',
            min_price: '156800000',
            max_price: '159939000',
            units_traded: '645.38767361',
            acc_trade_value: '103071234567',
            fluctate_rate_24H: '0.54'
          },
          {
            symbol: 'ETH',
            coinName: 'ì´ë”ë¦¬ì›€',
            opening_price: '4027000',
            closing_price: '4027000',
            min_price: '3900000',
            max_price: '4041000',
            units_traded: '17875.525049',
            acc_trade_value: '71982345678',
            fluctate_rate_24H: '-0.84'
          },
          {
            symbol: 'XRP',
            coinName: 'ë¦¬í”Œ',
            opening_price: '730',
            closing_price: '735',
            min_price: '720',
            max_price: '740',
            units_traded: '125674.123456',
            acc_trade_value: '92345678',
            fluctate_rate_24H: '0.96'
          },
          {
            symbol: 'ADA',
            coinName: 'ì—ì´ë‹¤',
            opening_price: '450',
            closing_price: '455',
            min_price: '445',
            max_price: '460',
            units_traded: '89234.567890',
            acc_trade_value: '40567890',
            fluctate_rate_24H: '1.56'
          },
          {
            symbol: 'DOT',
            coinName: 'í´ì¹´ë‹·',
            opening_price: '8500',
            closing_price: '8450',
            min_price: '8400',
            max_price: '8550',
            units_traded: '12345.678901',
            acc_trade_value: '104567890',
            fluctate_rate_24H: '-0.82'
          }
        ];
        
        gridApi.setGridOption('rowData', sampleData);
        console.log('ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.');
      } finally {
        loadingDiv.style.display = 'none';
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ AG Grid ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
      const gridDiv = document.getElementById('myGrid');
      agGrid.createGrid(gridDiv, gridOptions);
    });
  </script>
</body>
</html>